#
class Farsite_x25_remote_shell < BeEF::Core::Command

  def self.options
    @configuration = BeEF::Core::Configuration.instance
    beef_host = @configuration.get("beef.http.public") || @configuration.get("beef.http.host")
    return [
      { 'name' => 'scheme', 'type' => 'combobox', 'ui_label' => 'HTTP(s)', 'store_type' => 'arraystore',
          'store_fields' => ['http'], 'store_data' => [['HTTP'],['HTTPS']],
          'valueField' => 'http', 'displayField' => 'http', 'mode' => 'local', 'autoWidth' => true
      },
      { 'name' => 'rhost', 'ui_label' => 'Remote Host', 'value' => '10.0.0.1' },
      { 'name' => 'lhost', 'ui_label' => 'Local Host',  'value' => "#{beef_host}" },
      { 'name' => 'lport', 'ui_label' => 'Local Port',  'value' => '4444'      }
    ]
  end

  def post_execute
        save({'result' => @datastore['result']})
  end

end

